<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Add Transaction</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/awesomplete/1.1.5/awesomplete.min.css"
    />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/awesomplete/1.1.5/awesomplete.min.js"></script>

    <style>
      body {
        background-color: #f8f9fa;
      }
      .form-container {
        max-width: 600px;
        margin: 50px auto;
        background: white;
        padding: 30px;
        border-radius: 12px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
      }
      .form-label {
        font-weight: 500;
      }
      input[type="number"] {
        text-align: right;
      }
      .reset-icon {
        transition: transform 0.3s ease;
      }
      #resetGroupBtn:hover .reset-icon {
        transform: rotate(180deg);
      }
      #resetGroupBtn:active .reset-icon {
        transform: rotate(360deg);
      }
      .input-group .btn {
        border-left: 0;
      }
      .header-container {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 30px;
      }
      .back-button {
        background: none;
        border: none;
        padding: 5px;
        cursor: pointer;
        display: flex;
        align-items: center;
        transition: opacity 0.2s;
      }
      .back-button:hover {
        opacity: 0.7;
      }
      .header-title {
        flex: 1;
        text-align: center;
      }
    </style>
  </head>
  <body>
    <div class="form-container">
      <div class="header-container">
        <button 
          class="back-button" 
          onclick="goToTransactions()"
          title="Back to Transactions"
        >
          <img src="/images/previous.svg" alt="Previous" style="width: 30px; height: 30px;" />
        </button>
        <h4 class="header-title mb-0">
          <img src="/images/add.svg" alt="Add" style="width: 30px; height: 30px; vertical-align: middle; margin-right: 8px;" />
          Add Transaction
        </h4>
        <div style="width: 30px;"></div> <!-- Spacer for centering -->
      </div>

      <form id="transactionForm">
        <!-- Date -->
        <div class="mb-3">
          <label for="date" class="form-label">Date</label>
          <input
            type="date"
            id="date"
            name="date"
            class="form-control"
            required
          />
        </div>

        <!-- Time -->
        <div class="mb-3">
          <label for="time" class="form-label">Time</label>
          <input type="time" id="time" name="time" class="form-control" />
        </div>

        <!-- Transaction -->
        <div class="mb-3">
          <label for="transaction" class="form-label">Transaction</label>
          <input
            type="text"
            id="transaction"
            name="transaction"
            class="form-control"
            placeholder="e.g. Mua cà phê"
            required
            autofocus
          />
        </div>

        <!-- Group -->
        <div class="mb-3">
          <label for="group" class="form-label">Group</label>
          <select id="group" name="group" class="form-select" required>
            <option value="">-- Select Group --</option>
            <option value="Needs">Needs</option>
            <option value="Wants">Wants</option>
            <option value="Savings">Savings</option>
          </select>
        </div>

        <!-- Subgroup -->
        <div class="mb-3">
          <label for="subgroup" class="form-label">Subgroup</label>
          <select id="subgroup" name="subgroup" class="form-select" required>
            <option value="">-- Select Subgroup --</option>
          </select>
        </div>

        <!-- Category -->
        <div class="mb-3">
          <label for="category" class="form-label">Category</label>
          <input
            type="text"
            id="category"
            name="category"
            class="form-control"
            placeholder="Type or select..."
          />
          <button 
              type="button" 
              id="resetGroupBtn" 
              class="btn btn-outline-secondary"
              title="Reset Group"
              data-bs-toggle="tooltip"
              data-bs-placement="top"
            >
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-clockwise reset-icon" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"/>
                <path d="M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z"/>
              </svg>
            </button>
          <datalist id="categoryList"></datalist>
        </div>

        <!-- Amount -->
        <div class="mb-3">
          <label for="amount" class="form-label">Amount ( Nghìn Đồng )</label>
          <input
            type="text"
            id="amount"
            name="amount"
            class="form-control"
            inputmode="numeric"
            required
          />
        </div>

        <!-- Note -->
        <div class="mb-3">
          <label for="note" class="form-label">Note (optional)</label>
          <textarea
            id="note"
            name="note"
            class="form-control"
            rows="2"
            placeholder="Any additional info..."
          ></textarea>
        </div>

        <!-- Buttons -->
        <div class="d-flex justify-content-between mt-4">
          <button type="reset" class="btn btn-outline-secondary">Reset</button>
          <button type="submit" class="btn btn-primary">Save</button>
        </div>
      </form>
    </div>

    <script>
      function goToTransactions() {
        const params = new URLSearchParams(window.location.search);
        const configId = params.get('configId');
        if (configId) {
          window.location.href = '/transactions?configId=' + encodeURIComponent(configId);
        } else {
          window.location.href = '/';
        }
      }
    </script>

    <!-- logic add form -->
    <script type="module" src="/js/add.js"></script>
  </body>
</html>
